<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Registro - Mental Health Platform</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <div th:replace="~{fragments/navbar :: navbar(activePage='registros')}"></div>
    
    <div class="container">
        <div class="page-header">
            <div>
                <h1 class="page-title">Editar Registro</h1>
                <p class="page-subtitle">Atualize o registro de acompanhamento</p>
            </div>
            <a th:href="@{/registros}" class="btn btn-secondary">Voltar</a>
        </div>

        <div class="card">
            <form th:action="@{/registros/editar/{id}(id=${registro.id})}" method="post" th:object="${registro}">
                <h2 class="card-title mb-3">Dados do Registro</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="pacienteId" class="form-label">Paciente *</label>
                        <select id="pacienteId" name="pacienteId" class="form-select" required>
                            <option value="">Selecione um paciente...</option>
                            <option th:each="paciente : ${pacientes}" 
                                    th:value="${paciente.id}" 
                                    th:text="${paciente.nome}"
                                    th:selected="${registro.pacienteId == paciente.id}"></option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="dataRegistro" class="form-label">Data do Registro *</label>
                        <input type="date" id="dataRegistro" name="dataRegistro" class="form-input" 
                               th:value="${#temporals.format(registro.dataRegistro, 'yyyy-MM-dd')}" required readonly>
                        <small style="color: var(--text-secondary); font-size: 0.85rem;">Data não pode ser alterada</small>
                    </div>
                </div>

                <h3 class="card-title mt-3 mb-2" style="font-size: 1.1rem;">Indicadores</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label for="nivelHumor" class="form-label">Nível de Humor *</label>
                        <select id="nivelHumor" name="nivelHumor" class="form-select" required>
                            <option value="">Selecione...</option>
                            <option value="MUITO_BOM" th:selected="${registro.nivelHumor == 'MUITO_BOM'}">Muito Bom</option>
                            <option value="BOM" th:selected="${registro.nivelHumor == 'BOM'}">Bom</option>
                            <option value="NEUTRO" th:selected="${registro.nivelHumor == 'NEUTRO'}">Neutro</option>
                            <option value="RUIM" th:selected="${registro.nivelHumor == 'RUIM'}">Ruim</option>
                            <option value="MUITO_RUIM" th:selected="${registro.nivelHumor == 'MUITO_RUIM'}">Muito Ruim</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="nivelAnsiedade" class="form-label">Nível de Ansiedade *</label>
                        <select id="nivelAnsiedade" name="nivelAnsiedade" class="form-select" required>
                            <option value="">Selecione...</option>
                            <option value="NENHUMA" th:selected="${registro.nivelAnsiedade == 'NENHUMA'}">Nenhuma</option>
                            <option value="LEVE" th:selected="${registro.nivelAnsiedade == 'LEVE'}">Leve</option>
                            <option value="MODERADA" th:selected="${registro.nivelAnsiedade == 'MODERADA'}">Moderada</option>
                            <option value="GRAVE" th:selected="${registro.nivelAnsiedade == 'GRAVE'}">Grave</option>
                            <option value="MUITO_GRAVE" th:selected="${registro.nivelAnsiedade == 'MUITO_GRAVE'}">Muito Grave</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="horasSono" class="form-label">Horas de Sono *</label>
                        <input type="number" id="horasSono" name="horasSono" class="form-input" min="0" max="24" step="1" 
                               th:value="${registro.horasSono}" required>
                    </div>

                    <div class="form-group">
                        <label for="qualidadeDia" class="form-label">Qualidade do Dia (1-10) *</label>
                        <input type="number" id="qualidadeDia" name="qualidadeDia" class="form-input" min="1" max="10" step="1"
                               th:value="${registro.qualidadeDia}" required>
                        <small style="color: var(--text-secondary); font-size: 0.85rem;">1 = Péssimo, 10 = Excelente</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="praticouExercicio" class="form-label">Praticou Exercício? *</label>
                    <select id="praticouExercicio" name="praticouExercicio" class="form-select" required>
                        <option value="">Selecione...</option>
                        <option value="true" th:selected="${registro.praticouExercicio}">Sim</option>
                        <option value="false" th:selected="${!registro.praticouExercicio}">Não</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="anotacoes" class="form-label">Anotações</label>
                    <textarea id="anotacoes" name="anotacoes" class="form-textarea" rows="4" th:text="${registro.anotacoes}"></textarea>
                </div>

                <div class="flex-between mt-3">
                    <a th:href="@{/registros}" class="btn btn-secondary">Cancelar</a>
                    <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>
